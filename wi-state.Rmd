---
title: "Wisconsin State Frisbee Tournament Results"
output: html_document
date: "2024-08-17"
editor_options: 
  chunk_output_type: console
---


Authorization
```{r}
library(googlesheets4)

# De-authorize any existing token
googlesheets4::gs4_deauth()

# Explicitly authorize with the appropriate scope
googlesheets4::gs4_auth(
  scopes = "https://www.googleapis.com/auth/spreadsheets.readonly"
)
```

Read the sheet
```{r}
url <- "https://docs.google.com/spreadsheets/d/1NNZ0dWsWdY8BM3R6KGCDZAMMH_O_Xikl7_PB1SVsLSY/edit#gid=0"
Results.df <- googlesheets4::read_sheet(url, 
                                        na = "NA",
                                        col_types = "cncccccccccccccnnnnc"
                                        )
```

```{r}
names(Results.df)
```

Best MTA times, Open
```{r}
Xp <- Results.df |>
  dplyr::filter(Event == "SCF", Division == "Open") |>
  dplyr::select(Year, Event, Place, Name = "Player 1", 
                Time_s = "Scores (Distance, m; SCF, s; DDC, wins; etc)")
Xf <- Results.df |>
  dplyr::filter(Event == "SCF", Division == "Open") |>
  dplyr::select(Year, Event, Place, Name = "Player 1", 
                Time_s = "Scores 2")
X <- rbind(Xp, Xf)
X |> 
  dplyr::arrange(desc(Time_s)) |>
  print(n = 20)
```

Number of Overall wins, Open
```{r}
Results.df |>
  dplyr::filter(Event == "Overall", Division == "Open", Place == "1st") |>
  dplyr::select(Tournament, Year, Name = "Player 1") |>
  dplyr::group_by(Name) |>
  dplyr::summarise(Wins = dplyr::n()) |>
  dplyr::arrange(desc(Wins))
```

