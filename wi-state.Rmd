---
title: "Wisconsin State Frisbee Tournament Results"
output: html_document
date: "2024-08-17"
editor_options: 
  chunk_output_type: console
---


Authorization
```{r}
library(googlesheets4)

# De-authorize any existing token
googlesheets4::gs4_deauth()

# Explicitly authorize with the appropriate scope
googlesheets4::gs4_auth(
  scopes = "https://www.googleapis.com/auth/spreadsheets.readonly"
)
```

Read the sheet
```{r}
url <- "https://docs.google.com/spreadsheets/d/1NNZ0dWsWdY8BM3R6KGCDZAMMH_O_Xikl7_PB1SVsLSY/edit#gid=0"
Results.df <- googlesheets4::read_sheet(url,
                                        na = "NA",
                                        col_types = "cncccccccccccccnnnnc"
                                        )
```

```{r}
names(Results.df)
```

Bests
```{r}
div <- "Open"
eve <- "SCF"
Xp <- Results.df |>
  dplyr::filter(Event == eve, Division == div) |>
  dplyr::select(Year, Event, Division, Place, Name = "Player 1", 
                Time_s = "Scores (Distance, m; SCF, s; DDC, wins; etc)")
Xf <- Results.df |>
  dplyr::filter(Event == eve, Division == div) |>
  dplyr::select(Year, Event, Division, Place, Name = "Player 1", 
                Time_s = "Scores 2")
X <- rbind(Xp, Xf)
X |> 
  dplyr::arrange(desc(Time_s)) |>
  print(n = 20)
```

Number of 1st place finishes
```{r}
div <- "Women"
eve <- "SCF"
Results.df |>
  dplyr::filter(Event == eve, Division == div, Place == "1st") |>
  dplyr::select(Tournament, Year, Name = "Player 1") |>
  dplyr::group_by(Name) |>
  dplyr::summarise(
                   Event = eve,
                   Division = div,
                   Firsts = dplyr::n()
                   ) |>
  dplyr::arrange(desc(Firsts))
```

Number of podium finishes all events
```{r}
div <- "Open"
P1 <- Results.df |>
  dplyr::filter(Division == div) |>
  dplyr::select(Tournament, Year, Name = "Player 1") |>
  dplyr::filter(Name != "") |>
  dplyr::group_by(Name) |>
  dplyr::summarise(
                   Division = div,
                   Podiums = dplyr::n()
                   ) |>
  dplyr::arrange(desc(Podiums))
P2 <- Results.df |>
  dplyr::filter(Division == div) |>
  dplyr::select(Tournament, Year, Name = "Player 2") |>
  dplyr::filter(Name != "") |>
  dplyr::group_by(Name) |>
  dplyr::summarise(
                   Division = div,
                   Podiums = dplyr::n()
                   ) |>
  dplyr::arrange(desc(Podiums))
P3 <- Results.df |>
  dplyr::filter(Division == div) |>
  dplyr::select(Tournament, Year, Name = "Player 3") |>
  dplyr::filter(Name != "") |>
  dplyr::group_by(Name) |>
  dplyr::summarise(
                   Division = div,
                   Podiums = dplyr::n()
                   ) |>
  dplyr::arrange(desc(Podiums))

P <- dplyr::full_join(P1, P2, by = "Name")
P <- dplyr::full_join(P, P3, by = "Name")

P <- P |>
  dplyr::mutate_all(~ ifelse(is.na(.), 0, .))

P$Podiums <- P$Podiums.x + P$Podiums.y + P$Podiums

P |> 
  dplyr::select(Name, Podiums) |>
  dplyr::arrange(desc(Podiums)) |>
  print(n = 25)

```

